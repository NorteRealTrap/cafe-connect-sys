
> multipdv-system@2.0.0 build
> prisma generate && next build

Environment variables loaded from .env
Prisma schema loaded from prisma\schema.prisma

âœ” Generated Prisma Client (v5.22.0) to .\node_modules\@prisma\client in 703ms

Start by importing your Prisma Client (See: https://pris.ly/d/importing-client)

Tip: Want to react to database changes in your app as they happen? Discover how with Pulse: https://pris.ly/tip-1-pulse

 âš  You are using a non-standard "NODE_ENV" value in your environment. This creates inconsistencies in the project and is strongly advised against. Read more: https://nextjs.org/docs/messages/non-standard-node-env
  â–² Next.js 14.2.33
  - Environments: .env

   Creating an optimized production build ...
Failed to compile.

./src/app/api/categories/route.ts
Error: 
  [31mx[0m Expected ';', got 'import'
   ,-[[36;1;4mc:\Users\Windows\Documents\cafe-connect-sys-main\src\app\api\categories\route.ts[0m:1:1]
 [2m1[0m | import { auth } from '@/lib/auth'
 [2m2[0m | export const runtime = 'nodejs'
 [2m3[0m | import { NextRequest, NextResponse } from 'next/server' import { getServerSession } from 'next-auth/next'  import { prisma } from '@/lib/prisma'  export async function GET(request: NextRequest) {   try {     const session = await auth()     if (!session) {       return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })     }      const { searchParams } = new URL(request.url)     const establishmentId = searchParams.get('establishmentId')      const categories = await prisma.category.findMany({       where: {         ...(establishmentId && { establishmentId }),         isActive: true       },       orderBy: {         name: 'asc'       }     })      return NextResponse.json(categories)   } catch (error) {     console.error('Error fetching categories:', error)     return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 })   } } 
   : [31;1m                                                        ^^^^^^[0m
   `----

Caused by:
    Syntax Error

Import trace for requested module:
./src/app/api/categories/route.ts

./src/app/api/dashboard/route.ts
Error: 
  [31mx[0m Expected ';', got 'import'
   ,-[[36;1;4mc:\Users\Windows\Documents\cafe-connect-sys-main\src\app\api\dashboard\route.ts[0m:1:1]
 [2m1[0m | import { auth } from '@/lib/auth'
 [2m2[0m | export const runtime = 'nodejs'
 [2m3[0m | import { NextRequest, NextResponse } from 'next/server' import { getServerSession } from 'next-auth/next'  import { prisma } from '@/lib/prisma'  export async function GET(request: NextRequest) {   try {     const session = await auth()     if (!session) {       return NextResponse.json({ error: 'NÃƒÂ£o autorizado' }, { status: 401 })     }      const { searchParams } = new URL(request.url)     const establishmentId = searchParams.get('establishmentId')     const period = searchParams.get('period') || 'today'      if (!establishmentId) {       return NextResponse.json({ error: 'establishmentId ÃƒÂ© obrigatÃƒÂ³rio' }, { status: 400 })     }      const now = new Date()     let startDate = new Date()          switch (period) {       case 'today':         startDate.setHours(0, 0, 0, 0)         break       case 'week':         startDate.setDate(now.getDate() - 7)         startDate.setHours(0, 0, 0, 0)         break       case 'month':         startDate.setDate(now.getDate() - 30)         startDate.setHours(0, 0, 0, 0)         break     }      const [totalOrders, totalRevenue, topProducts, recentOrders, tableOccupation, ordersByStatus] = await Promise.all([       prisma.order.count({ where: { establishmentId, createdAt: { gte: startDate } } }),       prisma.order.aggregate({         where: { establishmentId, createdAt: { gte: startDate }, status: { in: ['COMPLETED'] } },         _sum: { total: true }       }),       prisma.orderItem.groupBy({         by: ['productId'],         where: {           order: {             establishmentId,             createdAt: { gte: startDate },             status: { in: ['COMPLETED', 'PREPARING', 'READY'] }           }         },         _sum: { quantity: true, totalPrice: true },         orderBy: { _sum: { quantity: 'desc' } },         take: 5       }),       prisma.order.findMany({         where: { establishmentId, createdAt: { gte: startDate } },         include: {           table: { select: { number: true } },           items: { select: { quantity: true, product: { select: { name: true } } } }         },         orderBy: { createdAt: 'desc' },         take: 10       }),       prisma.table.groupBy({         by: ['status'],         where: { establishmentId },         _count: true       }),       prisma.order.groupBy({         by: ['status'],         where: { establishmentId, createdAt: { gte: startDate } },         _count: true       })     ])      const productIds = topProducts.map(p => p.productId)     const products = await prisma.product.findMany({       where: { id: { in: productIds } },       select: { id: true, name: true, image: true, price: true }     })      const topProductsWithDetails = topProducts.map(item => {       const product = products.find(p => p.id === item.productId)       return { ...product, quantitySold: item._sum.quantity, revenue: item._sum.totalPrice }     })      const averageTicket = totalOrders > 0 ? (totalRevenue._sum.total?.toNumber() || 0) / totalOrders : 0      return NextResponse.json({       period,       summary: { totalOrders, totalRevenue: totalRevenue._sum.total?.toNumber() || 0, averageTicket },       topProducts: topProductsWithDetails,       recentOrders,       tableOccupation,       ordersByStatus     })   } catch (error) {     console.error('Error fetching dashboard data:', error)     return NextResponse.json({ error: 'Erro ao buscar dados do dashboard' }, { status: 500 })   } } 
   : [31;1m                                                        ^^^^^^[0m
   `----

Caused by:
    Syntax Error

Import trace for requested module:
./src/app/api/dashboard/route.ts

./src/app/api/establishments/route.ts
Error: 
  [31mx[0m Expected ';', got 'import'
   ,-[[36;1;4mc:\Users\Windows\Documents\cafe-connect-sys-main\src\app\api\establishments\route.ts[0m:1:1]
 [2m1[0m | import { auth } from '@/lib/auth'
 [2m2[0m | export const runtime = 'nodejs'
 [2m3[0m | import { NextRequest, NextResponse } from 'next/server' import { getServerSession } from 'next-auth/next'  import { prisma } from '@/lib/prisma'  export async function GET() {   try {     const session = await auth()      if (!session) {       return new NextResponse('Unauthorized', { status: 401 })     }      const establishments = await prisma.establishment.findMany({       where: { isActive: true },       include: {         users: {           where: { userId: session.user.id },           include: { user: true }         },         _count: {           select: {             products: true,             orders: true,             tables: true           }         }       }     })      return NextResponse.json(establishments)   } catch (error) {     console.error('Error fetching establishments:', error)     return new NextResponse('Internal Error', { status: 500 })   } }  export async function POST(request: NextRequest) {   try {     const session = await auth()      if (!session || !['ADMIN', 'MANAGER'].includes(session.user.role)) {       return new NextResponse('Unauthorized', { status: 401 })     }      const body = await request.json()     const {        name,        tradingName,        document,        email,        phone,        address,        type,        openingTime,        closingTime      } = body      const establishment = await prisma.establishment.create({       data: {         name,         tradingName,         document,         email,         phone,         address,         type,         openingTime,         closingTime,         users: {           create: {             userId: session.user.id,             role: 'OWNER'           }         }       }     })      return NextResponse.json(establishment)   } catch (error) {     console.error('Error creating establishment:', error)     return new NextResponse('Internal Error', { status: 500 })   } }
   : [31;1m                                                        ^^^^^^[0m
   `----

Caused by:
    Syntax Error

Import trace for requested module:
./src/app/api/establishments/route.ts

./src/app/api/orders/route.ts
Error: 
  [31mx[0m Expected ';', got 'import'
   ,-[[36;1;4mc:\Users\Windows\Documents\cafe-connect-sys-main\src\app\api\orders\route.ts[0m:1:1]
 [2m1[0m | import { auth } from '@/lib/auth'
 [2m2[0m | export const runtime = 'nodejs'
 [2m3[0m | import { NextRequest, NextResponse } from 'next/server' import { getServerSession } from 'next-auth/next'  import { prisma } from '@/lib/prisma' import { createOrderSchema } from '@/lib/validations/order' import { OrderStatus } from '@prisma/client' import { z } from 'zod'  export async function GET(request: NextRequest) {   try {     const session = await auth()     if (!session) {       return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })     }      const { searchParams } = new URL(request.url)     const establishmentId = searchParams.get('establishmentId')     const status = searchParams.get('status')      const orders = await prisma.order.findMany({       where: {         ...(establishmentId && { establishmentId }),         ...(status && status !== 'ALL' && { status: status as OrderStatus })       },       include: {         table: true,         items: {           include: {             product: {               include: {                 category: true               }             }           }         },         establishment: {           select: {             id: true,             name: true           }         }       },       orderBy: {         createdAt: 'desc'       }     })      return NextResponse.json(orders)   } catch (error) {     console.error('Error fetching orders:', error)     return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 })   } }  export async function POST(request: NextRequest) {   try {     const session = await auth()     if (!session) {       return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })     }      const body = await request.json()     const validatedData = createOrderSchema.parse(body)      // Buscar produtos para calcular preÃƒÂ§os     const productIds = validatedData.items.map(item => item.productId)     const products = await prisma.product.findMany({       where: {         id: { in: productIds },         establishmentId: validatedData.establishmentId,         isActive: true       }     })      if (products.length !== productIds.length) {       return NextResponse.json({ error: 'Um ou mais produtos nÃƒÂ£o encontrados' }, { status: 400 })     }      // Calcular subtotal e total     let subtotal = 0     const orderItems = validatedData.items.map(item => {       const product = products.find(p => p.id === item.productId)!       const itemTotal = product.price.toNumber() * item.quantity       subtotal += itemTotal        return {         productId: item.productId,         quantity: item.quantity,         unitPrice: product.price,         totalPrice: itemTotal,         notes: item.notes       }     })      const discount = validatedData.discount || 0     const total = subtotal * (1 - discount / 100)      const orderNumber = `PED-${Date.now().toString().slice(-8)}`      const order = await prisma.order.create({       data: {         orderNumber,         establishmentId: validatedData.establishmentId,         tableId: validatedData.tableId,         status: 'PENDING',         subtotal,         discount,         total,         customerName: validatedData.customerName,         customerPhone: validatedData.customerPhone,         notes: validatedData.notes,         createdById: session.user.id,         items: {           create: orderItems         }       },       include: {         table: true,         items: {           include: {             product: {               include: {                 category: true               }             }           }         }       }     })      if (validatedData.tableId) {       await prisma.table.update({         where: { id: validatedData.tableId },         data: { status: 'OCCUPIED' }       })     }      return NextResponse.json(order, { status: 201 })   } catch (error) {     if (error instanceof z.ZodError) {       return NextResponse.json({ error: 'Validation error', details: error.errors }, { status: 400 })     }     console.error('Error creating order:', error)     return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 })   } } 
   : [31;1m                                                        ^^^^^^[0m
   `----

Caused by:
    Syntax Error

Import trace for requested module:
./src/app/api/orders/route.ts

./src/app/api/print/route.ts
Error: 
  [31mx[0m Expected ';', got 'import'
   ,-[[36;1;4mc:\Users\Windows\Documents\cafe-connect-sys-main\src\app\api\print\route.ts[0m:1:1]
 [2m1[0m | import { auth } from '@/lib/auth'
 [2m2[0m | export const runtime = 'nodejs'
 [2m3[0m | import { NextRequest, NextResponse } from 'next/server'   import { prisma } from '@/lib/prisma'  export async function POST(request: NextRequest) {   try {     const session = await auth()     if (!session) {       return new NextResponse('Unauthorized', { status: 401 })     }      const { orderId, printType = 'CASHIER' } = await request.json()      // Buscar pedido     const order = await prisma.order.findUnique({       where: { id: orderId },       include: {         items: {           include: {             product: true           }         },         establishment: true,         table: true,         createdBy: {           select: { name: true }         }       }     })      if (!order) {       return new NextResponse('Order not found', { status: 404 })     }      // Gerar conteÃƒÂºdo do cupom     const printContent = generatePrintContent(order, printType)      // Registrar log de impressÃƒÂ£o     await prisma.orderPrint.create({       data: {         orderId: order.id,         type: printType,         content: printContent,         success: true       }     })      return NextResponse.json({        success: true,        content: printContent,       message: 'Cupom gerado com sucesso'     })    } catch (error) {     console.error('Error printing:', error)     return new NextResponse('Internal Error', { status: 500 })   } }  function generatePrintContent(order: any, printType: string): string {   const establishment = order.establishment   const date = new Date(order.createdAt).toLocaleString('pt-BR')      let content = ` ======================================== ${establishment.name.toUpperCase()} ${establishment.address || ''} ${establishment.phone || ''} ========================================  PEDIDO: ${order.orderNumber} DATA: ${date} OPERADOR: ${order.createdBy.name} ${order.customerName ? `CLIENTE: ${order.customerName}` : ''} ${order.table ? `MESA: ${order.table.number}` : ''} ${order.type === 'DELIVERY' ? 'TIPO: ENTREGA' : ''}  ---------------------------------------- ITENS: `    order.items.forEach((item: any) => {     content += `${item.quantity}x ${item.product.name}\n`     content += `   R$ ${Number(item.unitPrice).toFixed(2)} = R$ ${Number(item.totalPrice).toFixed(2)}\n`     if (item.notes) {       content += `   OBS: ${item.notes}\n`     }   })    content += ` ---------------------------------------- SUBTOTAL: R$ ${Number(order.subtotal).toFixed(2)} TAXA: R$ ${Number(order.tax).toFixed(2)} TOTAL: R$ ${Number(order.total).toFixed(2)} ----------------------------------------  ${order.notes ? `OBSERVAÃƒâ€¡Ãƒâ€¢ES: ${order.notes}` : ''}  Obrigado pela preferÃƒÂªncia! Volte sempre!  ======================================== `    return content } 
   : [31;1m                                                          ^^^^^^[0m
   `----

Caused by:
    Syntax Error

Import trace for requested module:
./src/app/api/print/route.ts


> Build failed because of webpack errors
